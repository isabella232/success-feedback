<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Segment Success Feedback!</title>
    <style type="text/css"> html {
        margin: 0;
        height: 100%;
        overflow: hidden;
    }

    iframe {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        border: 0;
    } </style>
    <script type="text/javascript">
      !function () {
        var analytics = window.analytics = window.analytics || [];
        if (!analytics.initialize)if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice."); else {
          analytics.invoked = !0;
          analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on"];
          analytics.factory = function (t) {
            return function () {
              var e = Array.prototype.slice.call(arguments);
              e.unshift(t);
              analytics.push(e);
              return analytics
            }
          };
          for (var t = 0; t < analytics.methods.length; t++) {
            var e = analytics.methods[t];
            analytics[e] = analytics.factory(e)
          }
          analytics.load = function (t) {
            var e = document.createElement("script");
            e.type = "text/javascript";
            e.async = !0;
            e.src = ("https:" === document.location.protocol ? "https://" : "http://") + "cdn.segment.com/analytics.js/v1/" + t + "/analytics.min.js";
            var n = document.getElementsByTagName("script")[0];
            n.parentNode.insertBefore(e, n)
          };
          analytics.SNIPPET_VERSION = "4.0.0";
          analytics.load("DyKLf6lEM4QGhmkmF561t0r5KgX2JbNd");
          analytics.page('Success Feedback Form');
        }
      }();
    </script>
</head>
<body>
<iframe id="typeform-full" width="100%" height="100%" frameborder="0"></iframe>

<script type="text/javascript">
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (decodeURIComponent(pair[0]) == variable) {
        return decodeURIComponent(pair[1]);
      }
    }
  }
  var requesterFirstName = getQueryVariable('name');
  var ticketId = getQueryVariable('id');
  var ticketTitle = getQueryVariable('title');
  var ticketUrl = getQueryVariable('url');
  var agent = getQueryVariable('agent');
  var userId = getQueryVariable('userId');

  window.builtUrl = `https://segment.typeform.com/to/kCwgH5?name=${requesterFirstName}&id=${ticketId}&url="https://${ticketUrl}"&title=${ticketTitle}&agent=${agent}&user-id${userId}`;
  document.getElementById('typeform-full').src = window.builtUrl;
</script>

<script type="text/javascript" src="https://s3-eu-west-1.amazonaws.com/share.typeform.com/embed.js"></script>

</body>
</html>

